{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\sehan\\\\Documents\\\\ReactFiles\\\\crwn-clothes\\\\crwn-clothes\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _objectSpread from\"C:\\\\Users\\\\sehan\\\\Documents\\\\ReactFiles\\\\crwn-clothes\\\\crwn-clothes\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(getSnapshotFromUserAuth),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(signInWithGoogle),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(onGoogleSignInStart),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(signInWithEmail),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(onEmailSignInStart),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(isUserAuthenticated),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(onCheckUserSession),_marked8=/*#__PURE__*/_regeneratorRuntime.mark(signOut),_marked9=/*#__PURE__*/_regeneratorRuntime.mark(onSignOutStart),_marked10=/*#__PURE__*/_regeneratorRuntime.mark(signUp),_marked11=/*#__PURE__*/_regeneratorRuntime.mark(signInAfterSignUp),_marked12=/*#__PURE__*/_regeneratorRuntime.mark(onSignUpSuccess),_marked13=/*#__PURE__*/_regeneratorRuntime.mark(onSignUpStart),_marked14=/*#__PURE__*/_regeneratorRuntime.mark(userSagas);import{takeLatest,put,all,call}from'redux-saga/effects';import UserActionTypes from'./user.types';import{googleProvider,auth,createUserProfileDocument,getCurrentUser}from'../../firebase/firebase.utils';import{signInSuccess,signInFailure,signOutSuccess,signOutFailure,signUpSuccess,signUpFailure}from'./user.actions';export function getSnapshotFromUserAuth(userAuth,additionalData){var userRef,userSnapshot;return _regeneratorRuntime.wrap(function getSnapshotFromUserAuth$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return call(createUserProfileDocument,userAuth,additionalData);case 3:userRef=_context.sent;_context.next=6;return userRef.get();case 6:userSnapshot=_context.sent;_context.next=9;return put(signInSuccess(_objectSpread({id:userSnapshot.id},userSnapshot.data)));case 9:_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);_context.next=15;return put(signInFailure(_context.t0));case 15:case\"end\":return _context.stop();}}},_marked,null,[[0,11]]);}export function signInWithGoogle(){var _ref,user;return _regeneratorRuntime.wrap(function signInWithGoogle$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return auth.signInWithPopup(googleProvider);case 3:_ref=_context2.sent;user=_ref.user;_context2.next=7;return getSnapshotFromUserAuth(user);case 7:_context2.next=13;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);_context2.next=13;return put(signInFailure(_context2.t0));case 13:case\"end\":return _context2.stop();}}},_marked2,null,[[0,9]]);}export function onGoogleSignInStart(){return _regeneratorRuntime.wrap(function onGoogleSignInStart$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return takeLatest(UserActionTypes.GOOGLE_SIGN_IN_START,signInWithGoogle);case 2:case\"end\":return _context3.stop();}}},_marked3);}export function signInWithEmail(_ref2){var _ref2$payload,email,password,_ref3,user;return _regeneratorRuntime.wrap(function signInWithEmail$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_ref2$payload=_ref2.payload,email=_ref2$payload.email,password=_ref2$payload.password;_context4.prev=1;_context4.next=4;return auth.signInWithEmailAndPassword(email,password);case 4:_ref3=_context4.sent;user=_ref3.user;_context4.next=8;return getSnapshotFromUserAuth(user);case 8:_context4.next=14;break;case 10:_context4.prev=10;_context4.t0=_context4[\"catch\"](1);_context4.next=14;return put(signInFailure(_context4.t0));case 14:case\"end\":return _context4.stop();}}},_marked4,null,[[1,10]]);}export function onEmailSignInStart(){return _regeneratorRuntime.wrap(function onEmailSignInStart$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return takeLatest(UserActionTypes.EMAIL_SIGN_IN_START,signInWithEmail);case 2:case\"end\":return _context5.stop();}}},_marked5);}export function isUserAuthenticated(){var userAuth;return _regeneratorRuntime.wrap(function isUserAuthenticated$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return getCurrentUser;case 3:userAuth=_context6.sent;if(userAuth){_context6.next=6;break;}return _context6.abrupt(\"return\");case 6:_context6.next=8;return getSnapshotFromUserAuth(userAuth);case 8:_context6.next=14;break;case 10:_context6.prev=10;_context6.t0=_context6[\"catch\"](0);_context6.next=14;return put(signInFailure(_context6.t0));case 14:case\"end\":return _context6.stop();}}},_marked6,null,[[0,10]]);}export function onCheckUserSession(){return _regeneratorRuntime.wrap(function onCheckUserSession$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return takeLatest(UserActionTypes.CHECK_USER_SESSION,isUserAuthenticated);case 2:case\"end\":return _context7.stop();}}},_marked7);}export function signOut(){return _regeneratorRuntime.wrap(function signOut$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.prev=0;_context8.next=3;return auth.signOut();case 3:_context8.next=5;return put(signOutSuccess());case 5:_context8.next=11;break;case 7:_context8.prev=7;_context8.t0=_context8[\"catch\"](0);_context8.next=11;return put(signOutFailure(_context8.t0));case 11:case\"end\":return _context8.stop();}}},_marked8,null,[[0,7]]);}export function onSignOutStart(){return _regeneratorRuntime.wrap(function onSignOutStart$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return takeLatest(UserActionTypes.SIGN_OUT_START,signOut);case 2:case\"end\":return _context9.stop();}}},_marked9);}export function signUp(_ref4){var _ref4$payload,email,password,displayName,_ref5,user;return _regeneratorRuntime.wrap(function signUp$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_ref4$payload=_ref4.payload,email=_ref4$payload.email,password=_ref4$payload.password,displayName=_ref4$payload.displayName;_context10.prev=1;_context10.next=4;return auth.createUserWithEmailAndPassword(email,password);case 4:_ref5=_context10.sent;user=_ref5.user;_context10.next=8;return put(signUpSuccess({user:user,additionalData:{displayName:displayName}}));case 8:_context10.next=14;break;case 10:_context10.prev=10;_context10.t0=_context10[\"catch\"](1);_context10.next=14;return put(signUpFailure(_context10.t0));case 14:case\"end\":return _context10.stop();}}},_marked10,null,[[1,10]]);}export function signInAfterSignUp(_ref6){var _ref6$payload,user,additionalData;return _regeneratorRuntime.wrap(function signInAfterSignUp$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_ref6$payload=_ref6.payload,user=_ref6$payload.user,additionalData=_ref6$payload.additionalData;_context11.next=3;return getSnapshotFromUserAuth(user,additionalData);case 3:case\"end\":return _context11.stop();}}},_marked11);}export function onSignUpSuccess(){return _regeneratorRuntime.wrap(function onSignUpSuccess$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.next=2;return takeLatest(UserActionTypes.SIGN_UP_SUCCESS,signInAfterSignUp);case 2:case\"end\":return _context12.stop();}}},_marked12);}export function onSignUpStart(){return _regeneratorRuntime.wrap(function onSignUpStart$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_context13.next=2;return takeLatest(UserActionTypes.SIGN_UP_START,signUp);case 2:case\"end\":return _context13.stop();}}},_marked13);}export function userSagas(){return _regeneratorRuntime.wrap(function userSagas$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:_context14.next=2;return all([call(onGoogleSignInStart),call(onEmailSignInStart),call(onCheckUserSession),call(onSignOutStart),call(onSignUpStart),call(onSignUpSuccess)]);case 2:case\"end\":return _context14.stop();}}},_marked14);}","map":{"version":3,"sources":["C:/Users/sehan/Documents/ReactFiles/crwn-clothes/crwn-clothes/client/src/redux/user/user.sagas.js"],"names":["getSnapshotFromUserAuth","signInWithGoogle","onGoogleSignInStart","signInWithEmail","onEmailSignInStart","isUserAuthenticated","onCheckUserSession","signOut","onSignOutStart","signUp","signInAfterSignUp","onSignUpSuccess","onSignUpStart","userSagas","takeLatest","put","all","call","UserActionTypes","googleProvider","auth","createUserProfileDocument","getCurrentUser","signInSuccess","signInFailure","signOutSuccess","signOutFailure","signUpSuccess","signUpFailure","userAuth","additionalData","userRef","get","userSnapshot","id","data","signInWithPopup","user","GOOGLE_SIGN_IN_START","payload","email","password","signInWithEmailAndPassword","EMAIL_SIGN_IN_START","CHECK_USER_SESSION","SIGN_OUT_START","displayName","createUserWithEmailAndPassword","SIGN_UP_SUCCESS","SIGN_UP_START"],"mappings":"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","sourcesContent":["import { takeLatest, put, all, call } from 'redux-saga/effects';\r\nimport UserActionTypes from './user.types';\r\nimport { googleProvider , auth, createUserProfileDocument, getCurrentUser} from '../../firebase/firebase.utils';\r\nimport { signInSuccess, signInFailure, signOutSuccess, signOutFailure, signUpSuccess, signUpFailure} from './user.actions';\r\n\r\n\r\nexport function* getSnapshotFromUserAuth(userAuth, additionalData){\r\n    try{\r\n        const userRef = yield call(createUserProfileDocument,userAuth, additionalData);\r\n        const userSnapshot = yield userRef.get();\r\n        yield put(signInSuccess({id: userSnapshot.id, ...userSnapshot.data }));\r\n    }\r\n    catch(error){\r\n        yield put(signInFailure(error));\r\n    }\r\n}\r\n\r\nexport function* signInWithGoogle(){\r\n    try{\r\n        const {user} = yield auth.signInWithPopup(googleProvider);\r\n        yield getSnapshotFromUserAuth(user);\r\n    }\r\n    catch(error){\r\n        yield put(signInFailure(error));\r\n    }\r\n}\r\n\r\nexport function* onGoogleSignInStart() {\r\n    yield takeLatest(UserActionTypes.GOOGLE_SIGN_IN_START,signInWithGoogle);\r\n}\r\n\r\n\r\nexport function* signInWithEmail({payload: {email, password}}){\r\n    try {\r\n        const {user} = yield auth.signInWithEmailAndPassword(email, password);\r\n        yield getSnapshotFromUserAuth(user);\r\n    } catch (error) {\r\n        yield put(signInFailure(error));\r\n    }\r\n}\r\n\r\nexport function* onEmailSignInStart() {\r\n    yield takeLatest(UserActionTypes.EMAIL_SIGN_IN_START,signInWithEmail);\r\n}\r\n\r\nexport function* isUserAuthenticated(){\r\n    try{\r\n        const userAuth = yield getCurrentUser;\r\n        if(!userAuth) return;\r\n        yield getSnapshotFromUserAuth(userAuth);\r\n    }\r\n    catch(error){\r\n        yield put(signInFailure(error));\r\n    }\r\n}\r\n\r\nexport function* onCheckUserSession(){\r\n    yield takeLatest(UserActionTypes.CHECK_USER_SESSION,isUserAuthenticated)  \r\n}\r\n\r\nexport function* signOut(){\r\n    try{\r\n        yield auth.signOut();\r\n        yield put(signOutSuccess());\r\n    }\r\n    catch(error){\r\n        yield put(signOutFailure(error));\r\n    }\r\n}\r\n\r\nexport function* onSignOutStart(){\r\n    yield takeLatest(UserActionTypes.SIGN_OUT_START,signOut);\r\n}\r\n\r\nexport function* signUp({payload : {email, password, displayName}}){\r\n    try{\r\n        const { user } = yield auth.createUserWithEmailAndPassword( email, password);  \r\n        yield put(signUpSuccess({user: user, additionalData: {displayName}}));\r\n    }\r\n    catch(error){\r\n        yield put(signUpFailure(error));\r\n    }\r\n}\r\nexport function* signInAfterSignUp({payload: {user, additionalData}}){\r\n    yield getSnapshotFromUserAuth(user,additionalData);\r\n}\r\nexport function* onSignUpSuccess(){\r\n    yield takeLatest(UserActionTypes.SIGN_UP_SUCCESS,signInAfterSignUp)\r\n}\r\n\r\nexport function* onSignUpStart(){\r\n    yield takeLatest(UserActionTypes.SIGN_UP_START,signUp);\r\n}\r\n\r\nexport function* userSagas(){\r\n    yield all([call(onGoogleSignInStart), \r\n               call(onEmailSignInStart), \r\n               call(onCheckUserSession),\r\n               call(onSignOutStart),\r\n               call(onSignUpStart),\r\n               call(onSignUpSuccess)\r\n               \r\n            ]);\r\n}\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}